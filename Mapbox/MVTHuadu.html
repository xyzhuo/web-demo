<html>

<head>
    <meta charset="utf-8" />
    <title>加载矢量瓦片</title>

    <script type="text/javascript" src="./lib/jquery/jquery-1.10.2.min.js">
    </script>
    <link href="./lib/mapbox-gl-js/mapbox-gl.css" rel="stylesheet">
    <script type="text/javascript" src="./lib/mapbox-gl-js/mapbox-gl.js"></script>
    <link href="./lib/mapbox-gl-js/plugins/mapbox-gl-draw.css" rel="stylesheet">
    <script type="text/javascript" src="./lib/mapbox-gl-js/plugins/mapbox-gl-draw.js"></script>
    <script type="text/javascript" src="./lib/mapbox-gl-js/iclient9-mapboxgl.js"></script>
    <script type="text/javascript" src="./lib/proj4/proj4.js"></script>


    <style>
        body {
            margin: 0;
            padding: 0;
        }
        
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
        
        .mb-popup {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        #info {
            display: block;
            position: relative;
            margin: 0px auto;
            width: 50%;
            padding: 10px;
            border: none;
            border-radius: 3px;
            font-size: 12px;
            text-align: center;
            color: #222;
            background: rgba(255, 255, 255, 0.6);
        }
        
        #layerList {
            position: absolute;
            right: 10px;
            top: 70px;
            display: none;
            height: 50%;
            overflow-x: hidden;
            overflow-y: scroll;
            background: rgba(255, 255, 255, 1);
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <div id='info' style="position: absolute; left: 10px;bottom: 10px; width: 20%;text-align: left;"></div>

    <div style="position: absolute; top: 20px; right: 20px;"><button onclick="isShowLayerListController()">图层控制</button></div>
    <div id="layerList">
        <!-- <label>
            <input type="checkbox" checked="checked" onchange="changeEle(this)" />checked
        </label><br /> -->
    </div>
    <script type="text/javascript">
        // 参考：https://blog.csdn.net/sun_falls/article/details/105223095
        // let huaduMapUrl = "http://localhost:8090/iserver/services/map-mvt-Huadu/restjsr/v1/vectortile/maps/Huadu/style.json";

        let huaduMapUrl = "./hdStyle.json";
        let sourceLayerArr = [];
        let sourceLayerObj = {};

        let map;
        $.get(huaduMapUrl).then((huaduGonganMapStyle) => {
            console.log("mapStyle", huaduGonganMapStyle);

            // let mapStyle = JSON.parse(JSON.stringify(huaduGonganMapStyle));
            // mapStyle.layers = [];

            map = new mapboxgl.Map({
                container: "map",
                style: huaduGonganMapStyle, //mapStyle, // huaduMapUrl,
                center: [113.21179685670018, 23.425180273500047],
                zoom: 10,
                crs: "EPSG:4326"
            });
            console.log("map", map);

            map.setMaxZoom(19);
        });
    </script>
</body>

</html>