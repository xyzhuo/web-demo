<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>加载esri rest地图</title>

    <!-- 1 引入Leaflet依赖 -->
    <!-- 1.1 Leaflet CSS依赖 -->
    <link rel="stylesheet" href="../lib/leaflet/leaflet@1.7.1/dist/leaflet.css">
    <!-- 1.2 Leaflet JS依赖 -->
    <script type="text/javascript" src="../lib/leaflet/leaflet@1.7.1/dist/leaflet.js"></script>

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script> -->

    <!-- 2 引入SuperMap提供的Leaflet插件依赖 -->
    <!-- 2.1 引入SuperMap提供的Leaflet插件CSS依赖 -->
    <link rel="stylesheet" href="../lib/leaflet/leaflet.supermap.iclient/10.1.2/iclient-leaflet.css">
    <!-- 2.2 引入SuperMap提供的Leaflet插件CSS依赖 -->
    <script type="text/javascript" src="../lib/leaflet/leaflet.supermap.iclient/10.1.2/iclient-leaflet.js"></script>

    <!-- 投影定义 -->
    <script src="../lib/leaflet/proj4js/2.4.3/proj4.js"></script>
    <!-- Leaflet对proj4的扩展插件 -->
    <script src="../lib/leaflet/proj4leaflet/1.0.1/proj4leaflet.js"></script>

    <!-- leaflet-esri -->
    <script src="../lib/leaflet/leaflet.esri@v3.0.8/esri-leaflet.js"></script>

    <!-- 坐标拾取 -->
    <script src="https://cdn.jsdelivr.net/npm/leaflet-mouse-position@1.2.0/src/L.Control.MousePosition.min.js"></script>

</head>

<body style=" margin: 0;overflow: hidden;background: #fff;width: 100%;height:100%;position: absolute;top: 0;">
    <div id="map" style="margin:0 auto;width: 100%;height: 100%"></div>
    <script type="text/javascript">
        /**
         * 参考：
         * https://blog.csdn.net/u012320231/article/details/81905986
         * 
         */


        const CRS_4490 = new L.Proj.CRS("EPSG:4490", "+proj=longlat +ellps=GRS80 +no_defs", {
            resolutions: [
                1.40625,
                0.703125,
                0.3515625,
                0.17578125,
                0.087890625,
                0.0439453125,
                0.02197265625,
                0.010986328125,
                0.0054931640625,
                0.00274658203125,
                0.001373291015625,
                6.866455078125E-4,
                3.4332275390625E-4,
                1.71661376953125E-4,
                8.58306884765625E-5,
                4.291534423828125E-5,
                2.1457672119140625E-5,
                1.0728836059570312E-5,
                5.364418029785156E-6,
                2.682209064925356E-6,
                1.3411045324626732E-6
            ],
            origin: [-180, 90]
        });

        const map = L.map("map", {
            center: [19.90202026492476, 110.72694956565432],
            zoom: 10,
            crs: CRS_4490
        });

        L.control.mousePosition({
            "position": "bottomleft"
        }).addTo(map);

        const circle = L.circle([19.90202026492476, 110.72694956565432], {
            radius: 100,
            color: "red",
            fillColor: "red",
            fillOpacity: 3
        }).addTo(map);
        circle.bindPopup("这个是点图标的弹框"); // 绑定到图元，点击图元时显示

        let url = "https://106.15.40.105:8090/iserver/services/map-tianditu/rest/maps/矢量底图_经纬度";
        L.supermap.tiledMapLayer(url).addTo(map);

        // // 动态图层加载
        // let dynamicLayer = L.esri.dynamicMapLayer({
        //     url: "http://yzltmap.hniplan.com/arcgis/rest/services/hainan/2016年海南省生态保护红线/MapServer",
        //     opacity: 0.8,
        //     f: "json"
        // });
        // map.addLayer(dynamicLayer);


        // 要素图层加载
        let esriUrl = "http://map.geoq.cn/arcgis/rest/services/ChinaOnlineCommunity/MapServer/3"
        let featureLayer = L.esri.featureLayer({
            url: esriUrl
        });
        map.addLayer(featureLayer);
    </script>
</body>

</html>